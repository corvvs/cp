# 問題

https://atcoder.jp/contests/arc080/tasks/arc080_c

# メモ

(全く証明になってない)

ルールを変えて、抜いたものを**先頭に**ではなく**末尾に**追加する、とした場合どうなるだろうか？

まず、カードの列から2枚選んで抜くのだが、この2枚は隣り合っている必要はない。\
しかし、カードが抜けた箇所をまたいでさらにカードを抜くことができなくなる。\
このことより、

- カードの列は、すでにカードが抜かれた場所により部分列に区切られる
- カードを抜くときは2枚を同じ部分列から抜く必要がある
- カードを抜くことでできる部分列の長さは偶数でなければならない
  - 抜く2枚のうち左側は(0-indexedで)偶数番目、右側は奇数番目のカードを選ぶ必要がある

これらのルールを守ってカードを抜くことになる。

ということで、原理的には、以下の手順で辞書順最小の列を構成できる:

0. `p`全体を1つの部分列とみなす
1. 残った部分列の偶数番目にあるカードの中で最も小さいものを抜く
2. 抜いたカードより右かつ奇数番目にある最も小さいカードを抜く
3. 抜いた2枚を`q`の末尾に追加する
4. 元の部分列を抜いた2枚のカードで区切り、新しい部分列を作る
5. まだカードが残っているなら1.に戻る

馬鹿正直にやると`O(N^2)`なので、もう少し早くしたい。