# 問題: ABC122 D - We Like AGC 

https://atcoder.jp/contests/abc122/tasks/abc122_d

# メモ

> - `A`, `C`, `G`, `T` 以外の文字を含まない。
> - `AGC`を部分文字列として含まない。
> - 隣接する2文字の入れ替えを1回行うことで上記の条件に違反させることはできない。

「上記の条件に」とあるが、文字を入れ替えても文字種は増減しないので、実際には２番目の条件のみ考えればよい。

`N = 4`の時、上記条件を全て満たす(=properな)文字列が**マッチしてはならないパターン**を列挙すると:

- `AGC*`
- `GAC*`
- `ACG*`
- `*AGC`
- `*GAC`
- `*ACG`
- `A*GC`
- `AG*C`

`N >= 4`の時、properな文字列の任意の長さ4の部分文字列は上記のパターンのどれにもマッチしてはならない。\
従って特に末尾の4文字は上記のパターンのどれにもマッチしてはならない。

長さ`N+1`のproperな文字列は、長さ`N`のproperな文字列に、上記のパターンにマッチしないように1文字追加することで得られる。\
これは、`[ATGC]`からなる長さ4の文字列のうち上記パターンのどれにもマッチしないものだけをリストアップしておくと、このリストの要素から別の要素への遷移と考えてDPができる。

# 余談

https://twitter.com/evima0/status/1109820549063036931

> 昔の AtCoder (りんごさん体制になる前) だったら D で N <= 10^18 という問題が旧 ARC の後半で出せたと思いますが、

「このリストの要素から別の要素への遷移」を行列の形にして行列累乗することになりそう。

