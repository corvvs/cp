# 問題: ABC003 D - AtCoder社の冬 

https://atcoder.jp/contests/abc003/tasks/abc003_4

# メモ

「オブジェクト」=デスクまたはサーバーラック、とすると、

`[長方形X*Yを張るようにオブジェクトを配置する場合の数](1) * [長方形X*Yを長方形C*Rの内部に配置する場合の数](2) * [D+L箇所の場所のうちD箇所にデスクを配置する場合の数](3)`が答え。

`(2)`は`(C-X-1)*(R-Y-1)`, `(3)`は`combination(D+L,D)`で計算できる。\
問題は`(1)`.

長方形`X*Y`の縦横のうち少なくとも一方が1の場合は単純なので、以下ではどちらも2以上のケースのみ考える。

長方形`X*Y`のどの辺にも1つ以上のオブジェクトがなければならない。\
もし４辺の上にあるオブジェクトの数と配置が確定しているなら、残ったオブジェクトは長方形の内部に好きに配置してよい。\
この配置の数は`combination(残ったオブジェクトの数, (X-2)*(Y-2))`.

「４辺の上にあるオブジェクトの数と配置」については次のように考える:

- 四隅(左上・左下・右上・右下)のオブジェクトの個数(0 or 1)
- ４辺のうち四隅を除いた部分にあるオブジェクトの個数(0~`X-2` or `Y-2`)
  - 個数が決まると、配置パターンの数は`combination(X-2 or Y-2, オブジェクトの個数)`で計算できる

これらを全て列挙し、そこからオブジェクトが無い辺を含むパターンを除去する。\
全パターンの数は`O(16 X^2 Y^2)`なので十分に間に合うはず。\
・・・だがRubyではもう少し工夫が必要。
